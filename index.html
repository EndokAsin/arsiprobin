<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Manajemen Dosen</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --success: #2ecc71;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
            --light-gray: #f5f7fa;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        body {
            background-color: var(--light-gray);
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background-color: var(--primary);
            color: white;
            padding: 20px 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .logo i {
            color: var(--secondary);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* Main Content */
        .main-content {
            display: flex;
            margin-top: 20px;
            gap: 20px;
        }

        /* Sidebar */
        .sidebar {
            width: 250px;
            background-color: white;
            border-radius: 10px;
            box-shadow: var(--shadow);
            padding: 20px;
            height: fit-content;
        }

        .sidebar-nav {
            list-style: none;
        }

        .sidebar-nav li {
            margin-bottom: 10px;
        }

        .sidebar-nav a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            color: var(--dark);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .sidebar-nav a:hover {
            background-color: var(--light);
            color: var(--secondary);
        }

        .sidebar-nav a.active {
            background-color: var(--secondary);
            color: white;
        }

        .sidebar-nav i {
            width: 20px;
        }

        /* Content Area */
        .content {
            flex: 1;
            background-color: white;
            border-radius: 10px;
            box-shadow: var(--shadow);
            padding: 25px;
            min-height: 80vh;
        }

        .page-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light);
        }

        .page-title h2 {
            color: var(--primary);
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--secondary);
            color: white;
        }

        .btn-primary:hover {
            background-color: #2980b9;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-warning {
            background-color: var(--warning);
            color: white;
        }

        .btn-danger {
            background-color: var(--accent);
            color: white;
        }

        /* Dashboard Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: var(--light);
            padding: 20px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        .stat-icon.report {
            background-color: rgba(52, 152, 219, 0.2);
            color: var(--secondary);
        }

        .stat-icon.task {
            background-color: rgba(46, 204, 113, 0.2);
            color: var(--success);
        }

        .stat-icon.research {
            background-color: rgba(155, 89, 182, 0.2);
            color: #9b59b6;
        }

        .stat-icon.job {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--warning);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        table th {
            background-color: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
        }

        table td {
            padding: 15px;
            border-bottom: 1px solid var(--light);
        }

        table tr:hover {
            background-color: rgba(236, 240, 241, 0.5);
        }

        .badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-success {
            background-color: rgba(46, 204, 113, 0.2);
            color: var(--success);
        }

        .badge-warning {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--warning);
        }

        .badge-danger {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--accent);
        }

        .badge-info {
            background-color: rgba(52, 152, 219, 0.2);
            color: var(--secondary);
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 6px 10px;
            border-radius: 4px;
            background-color: transparent;
            border: 1px solid;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
        }

        .action-btn.edit {
            color: var(--secondary);
            border-color: var(--secondary);
        }

        .action-btn.delete {
            color: var(--accent);
            border-color: var(--accent);
        }

        .action-btn.view {
            color: var(--success);
            border-color: var(--success);
        }

        .action-btn:hover {
            color: white;
        }

        .action-btn.edit:hover {
            background-color: var(--secondary);
        }

        .action-btn.delete:hover {
            background-color: var(--accent);
        }

        .action-btn.view:hover {
            background-color: var(--success);
        }

        /* Forms */
        .form-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: border 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
        }

        .form-row {
            display: flex;
            gap: 20px;
        }

        .form-row .form-group {
            flex: 1;
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light);
        }

        .modal-header h3 {
            color: var(--primary);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        /* Login Page */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }

        .login-box {
            background-color: white;
            border-radius: 10px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 400px;
            padding: 40px;
            text-align: center;
        }

        .login-box h1 {
            margin-bottom: 10px;
            color: var(--primary);
        }

        .login-box p {
            margin-bottom: 30px;
            color: var(--gray);
        }

        /* Footer */
        footer {
            margin-top: 40px;
            text-align: center;
            padding: 20px 0;
            color: var(--gray);
            border-top: 1px solid var(--light);
        }

        /* Responsive */
        @media (max-width: 992px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }

        @media (max-width: 576px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen (Initially Visible) -->
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <div class="logo" style="justify-content: center; margin-bottom: 20px;">
                <i class="fas fa-chalkboard-teacher"></i>
                <span>Manajemen Dosen</span>
            </div>
            <h1>Selamat Datang</h1>
            <p>Silakan masuk untuk mengakses sistem</p>
            
            <form id="loginForm">
                <div class="form-group">
                    <input type="email" id="email" class="form-control" placeholder="Email" required>
                </div>
                <div class="form-group">
                    <input type="password" id="password" class="form-control" placeholder="Password" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <i class="fas fa-sign-in-alt"></i> Masuk
                </button>
            </form>
            
            <div style="margin-top: 20px; color: var(--gray); font-size: 0.9rem;">
                <p>Gunakan email: admin@kampus.id dan password: admin123 untuk demo</p>
            </div>
        </div>
    </div>

    <!-- Main App (Initially Hidden) -->
    <div id="appContainer" style="display: none;">
        <!-- Header -->
        <header>
            <div class="container header-content">
                <div class="logo">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <span>Sistem Manajemen Dosen</span>
                </div>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">AD</div>
                    <div>
                        <div id="userName">Administrator</div>
                        <div style="font-size: 0.8rem; color: #bdc3c7;" id="userRole">Admin</div>
                    </div>
                    <button id="logoutBtn" class="btn btn-danger" style="padding: 8px 15px;">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="container main-content">
            <!-- Sidebar -->
            <nav class="sidebar">
                <ul class="sidebar-nav">
                    <li><a href="#" class="active" data-page="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li><a href="#" data-page="reports"><i class="fas fa-file-alt"></i> Laporan</a></li>
                    <li><a href="#" data-page="tasks"><i class="fas fa-tasks"></i> Tugas</a></li>
                    <li><a href="#" data-page="research"><i class="fas fa-flask"></i> Penelitian</a></li>
                    <li><a href="#" data-page="jobdesk"><i class="fas fa-briefcase"></i> Job Desk</a></li>
                    <li><a href="#" data-page="lecturers"><i class="fas fa-users"></i> Data Dosen</a></li>
                    <li><a href="#" data-page="profile"><i class="fas fa-user-cog"></i> Profil</a></li>
                </ul>
            </nav>

            <!-- Content Area -->
            <main class="content">
                <!-- Dashboard Page -->
                <div id="dashboardPage" class="page-content">
                    <div class="page-title">
                        <h2><i class="fas fa-tachometer-alt"></i> Dashboard</h2>
                        <div>Selamat datang di Sistem Manajemen Dosen</div>
                    </div>

                    <!-- Stats Cards -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon report">
                                <i class="fas fa-file-alt"></i>
                            </div>
                            <div class="stat-value" id="reportCount">12</div>
                            <div class="stat-label">Laporan</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon task">
                                <i class="fas fa-tasks"></i>
                            </div>
                            <div class="stat-value" id="taskCount">8</div>
                            <div class="stat-label">Tugas</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon research">
                                <i class="fas fa-flask"></i>
                            </div>
                            <div class="stat-value" id="researchCount">5</div>
                            <div class="stat-label">Penelitian</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon job">
                                <i class="fas fa-briefcase"></i>
                            </div>
                            <div class="stat-value" id="jobdeskCount">6</div>
                            <div class="stat-label">Job Desk</div>
                        </div>
                    </div>

                    <!-- Recent Activities -->
                    <h3 style="margin-top: 30px; margin-bottom: 15px;">Aktivitas Terbaru</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Tanggal</th>
                                    <th>Aktivitas</th>
                                    <th>Jenis</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="recentActivities">
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Reports Page -->
                <div id="reportsPage" class="page-content" style="display: none;">
                    <div class="page-title">
                        <h2><i class="fas fa-file-alt"></i> Manajemen Laporan</h2>
                        <button class="btn btn-primary" id="addReportBtn">
                            <i class="fas fa-plus"></i> Tambah Laporan
                        </button>
                    </div>

                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Judul Laporan</th>
                                    <th>Dosen</th>
                                    <th>Tanggal</th>
                                    <th>Jenis</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="reportsTable">
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Tasks Page -->
                <div id="tasksPage" class="page-content" style="display: none;">
                    <div class="page-title">
                        <h2><i class="fas fa-tasks"></i> Manajemen Tugas</h2>
                        <button class="btn btn-primary" id="addTaskBtn">
                            <i class="fas fa-plus"></i> Tambah Tugas
                        </button>
                    </div>

                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Judul Tugas</th>
                                    <th>Dosen</th>
                                    <th>Deadline</th>
                                    <th>Prioritas</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="tasksTable">
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Research Page -->
                <div id="researchPage" class="page-content" style="display: none;">
                    <div class="page-title">
                        <h2><i class="fas fa-flask"></i> Manajemen Penelitian</h2>
                        <button class="btn btn-primary" id="addResearchBtn">
                            <i class="fas fa-plus"></i> Tambah Penelitian
                        </button>
                    </div>

                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Judul Penelitian</th>
                                    <th>Ketua Peneliti</th>
                                    <th>Tahun</th>
                                    <th>Sumber Dana</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="researchTable">
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Job Desk Page -->
                <div id="jobdeskPage" class="page-content" style="display: none;">
                    <div class="page-title">
                        <h2><i class="fas fa-briefcase"></i> Manajemen Job Desk</h2>
                        <button class="btn btn-primary" id="addJobdeskBtn">
                            <i class="fas fa-plus"></i> Tambah Job Desk
                        </button>
                    </div>

                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Nama Job Desk</th>
                                    <th>Dosen</th>
                                    <th>Departemen</th>
                                    <th>Beban Kerja</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="jobdeskTable">
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Lecturers Page -->
                <div id="lecturersPage" class="page-content" style="display: none;">
                    <div class="page-title">
                        <h2><i class="fas fa-users"></i> Data Dosen</h2>
                        <button class="btn btn-primary" id="addLecturerBtn">
                            <i class="fas fa-plus"></i> Tambah Dosen
                        </button>
                    </div>

                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Nama</th>
                                    <th>NIDN</th>
                                    <th>Departemen</th>
                                    <th>Jabatan</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="lecturersTable">
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Profile Page -->
                <div id="profilePage" class="page-content" style="display: none;">
                    <div class="page-title">
                        <h2><i class="fas fa-user-cog"></i> Profil Pengguna</h2>
                    </div>

                    <div class="form-container">
                        <div class="form-group">
                            <label for="profileName">Nama Lengkap</label>
                            <input type="text" id="profileName" class="form-control" value="Administrator">
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="profileEmail">Email</label>
                                <input type="email" id="profileEmail" class="form-control" value="admin@kampus.id">
                            </div>
                            <div class="form-group">
                                <label for="profilePhone">Telepon</label>
                                <input type="text" id="profilePhone" class="form-control" value="081234567890">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="profileDepartment">Departemen</label>
                            <input type="text" id="profileDepartment" class="form-control" value="Teknik Informatika">
                        </div>
                        
                        <div class="form-group">
                            <label for="profilePosition">Jabatan</label>
                            <input type="text" id="profilePosition" class="form-control" value="Admin Sistem">
                        </div>
                        
                        <div class="form-group">
                            <label for="profileBio">Bio</label>
                            <textarea id="profileBio" class="form-control">Administrator sistem manajemen dosen dengan hak akses penuh.</textarea>
                        </div>
                        
                        <button class="btn btn-primary">
                            <i class="fas fa-save"></i> Simpan Perubahan
                        </button>
                    </div>
                </div>
            </main>
        </div>

        <!-- Footer -->
        <footer>
            <div class="container">
                <p>Sistem Manajemen Dosen &copy; 2023 - Universitas Contoh</p>
                <p style="font-size: 0.8rem; margin-top: 5px;">Dikembangkan untuk mempermudah pengelolaan data dosen</p>
            </div>
        </footer>
    </div>

    <!-- Modal for Adding/Editing Data -->
    <div id="dataModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Tambah Data Baru</h3>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <form id="dataForm">
                <div id="modalFormContent">
                    <!-- Form content will be dynamically inserted here -->
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-primary" id="submitModalBtn">
                        <i class="fas fa-save"></i> Simpan
                    </button>
                    <button type="button" class="btn btn-danger" id="cancelModalBtn">
                        <i class="fas fa-times"></i> Batal
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://pnjhoemtqdoalndiyjpj.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_wTy_6pXB_Q0Aukg_NeBUfQ_6u71s-Ll';
        
        // Initialize Supabase client
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        
        // Global state
        let currentUser = null;
        let currentPage = 'dashboard';
        let currentModalType = '';
        let editingId = null;
        
        // Sample data (in a real app, this would come from Supabase)
        const sampleData = {
            reports: [
                { id: 1, title: 'Laporan Triwulan I', lecturer: 'Dr. Ahmad Sanusi', date: '2023-03-31', type: 'Akademik', status: 'Disetujui' },
                { id: 2, title: 'Laporan Penelitian', lecturer: 'Prof. Budi Santoso', date: '2023-04-15', type: 'Penelitian', status: 'Dalam Review' },
                { id: 3, title: 'Laporan Pengabdian', lecturer: 'Dr. Citra Dewi', date: '2023-04-20', type: 'Pengabdian', status: 'Draft' }
            ],
            tasks: [
                { id: 1, title: 'Review Jurnal', lecturer: 'Dr. Ahmad Sanusi', deadline: '2023-05-10', priority: 'Tinggi', status: 'Dalam Proses' },
                { id: 2, title: 'Penyusunan RPS', lecturer: 'Prof. Budi Santoso', deadline: '2023-05-05', priority: 'Sedang', status: 'Selesai' },
                { id: 3, title: 'Bimbingan Skripsi', lecturer: 'Dr. Citra Dewi', deadline: '2023-05-15', priority: 'Tinggi', status: 'Belum Dimulai' }
            ],
            research: [
                { id: 1, title: 'AI dalam Pendidikan', researcher: 'Dr. Ahmad Sanusi', year: '2023', fundSource: 'Internal', status: 'Aktif' },
                { id: 2, title: 'Sistem Informasi Cerdas', researcher: 'Prof. Budi Santoso', year: '2023', fundSource: 'Eksternal', status: 'Selesai' },
                { id: 3, title: 'Pengembangan IoT', researcher: 'Dr. Citra Dewi', year: '2023', fundSource: 'Internal', status: 'Dalam Review' }
            ],
            jobdesks: [
                { id: 1, title: 'Koordinator MK', lecturer: 'Dr. Ahmad Sanusi', department: 'Teknik Informatika', workload: '10 jam/minggu', status: 'Aktif' },
                { id: 2, title: 'Ketua Lab', lecturer: 'Prof. Budi Santoso', department: 'Sistem Informasi', workload: '8 jam/minggu', status: 'Aktif' },
                { id: 3, title: 'Pembimbing Akademik', lecturer: 'Dr. Citra Dewi', department: 'Teknik Komputer', workload: '6 jam/minggu', status: 'Selesai' }
            ],
            lecturers: [
                { id: 1, name: 'Dr. Ahmad Sanusi', nidn: '01234567', department: 'Teknik Informatika', position: 'Lektor', status: 'Aktif' },
                { id: 2, name: 'Prof. Budi Santoso', nidn: '01234568', department: 'Sistem Informasi', position: 'Guru Besar', status: 'Aktif' },
                { id: 3, name: 'Dr. Citra Dewi', nidn: '01234569', department: 'Teknik Komputer', position: 'Lektor Kepala', status: 'Aktif' }
            ]
        };
        
        // DOM Elements
        const loginScreen = document.getElementById('loginScreen');
        const appContainer = document.getElementById('appContainer');
        const loginForm = document.getElementById('loginForm');
        const logoutBtn = document.getElementById('logoutBtn');
        const userAvatar = document.getElementById('userAvatar');
        const userName = document.getElementById('userName');
        const userRole = document.getElementById('userRole');
        const sidebarLinks = document.querySelectorAll('.sidebar-nav a');
        const pageContents = document.querySelectorAll('.page-content');
        const modal = document.getElementById('dataModal');
        const closeModalBtn = document.getElementById('closeModal');
        const cancelModalBtn = document.getElementById('cancelModalBtn');
        const modalForm = document.getElementById('dataForm');
        const modalFormContent = document.getElementById('modalFormContent');
        const modalTitle = document.getElementById('modalTitle');
        const submitModalBtn = document.getElementById('submitModalBtn');
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is already logged in (from localStorage)
            const savedUser = localStorage.getItem('dosenManagementUser');
            if (savedUser) {
                login(JSON.parse(savedUser));
            }
            
            // Setup event listeners
            setupEventListeners();
            
            // Load initial data
            updateDashboardStats();
            loadTableData('reports');
            loadTableData('tasks');
            loadTableData('research');
            loadTableData('jobdesks');
            loadTableData('lecturers');
            loadRecentActivities();
        });
        
        // Setup event listeners
        function setupEventListeners() {
            // Login form
            loginForm.addEventListener('submit', handleLogin);
            
            // Logout button
            logoutBtn.addEventListener('click', handleLogout);
            
            // Sidebar navigation
            sidebarLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.getAttribute('data-page');
                    switchPage(page);
                });
            });
            
            // Add buttons
            document.getElementById('addReportBtn').addEventListener('click', () => openModal('report'));
            document.getElementById('addTaskBtn').addEventListener('click', () => openModal('task'));
            document.getElementById('addResearchBtn').addEventListener('click', () => openModal('research'));
            document.getElementById('addJobdeskBtn').addEventListener('click', () => openModal('jobdesk'));
            document.getElementById('addLecturerBtn').addEventListener('click', () => openModal('lecturer'));
            
            // Modal buttons
            closeModalBtn.addEventListener('click', closeModal);
            cancelModalBtn.addEventListener('click', closeModal);
            
            // Modal form submission
            modalForm.addEventListener('submit', handleFormSubmit);
            
            // Close modal when clicking outside
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal();
                }
            });
        }
        
        // Handle login
        async function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            // Demo login - in a real app, this would authenticate with Supabase
            if (email === 'admin@kampus.id' && password === 'admin123') {
                const user = {
                    id: 1,
                    name: 'Administrator',
                    email: email,
                    role: 'Admin',
                    avatar: 'AD'
                };
                
                // Save to localStorage
                localStorage.setItem('dosenManagementUser', JSON.stringify(user));
                
                // Login
                login(user);
            } else {
                alert('Login gagal. Gunakan email: admin@kampus.id dan password: admin123');
            }
        }
        
        // Login function
        function login(user) {
            currentUser = user;
            
            // Update UI
            userAvatar.textContent = user.avatar;
            userName.textContent = user.name;
            userRole.textContent = user.role;
            
            // Switch screens
            loginScreen.style.display = 'none';
            appContainer.style.display = 'block';
            
            // Show dashboard
            switchPage('dashboard');
        }
        
        // Handle logout
        function handleLogout() {
            localStorage.removeItem('dosenManagementUser');
            currentUser = null;
            
            // Reset form
            loginForm.reset();
            
            // Switch screens
            appContainer.style.display = 'none';
            loginScreen.style.display = 'flex';
        }
        
        // Switch between pages
        function switchPage(page) {
            // Update current page
            currentPage = page;
            
            // Update active link in sidebar
            sidebarLinks.forEach(link => {
                if (link.getAttribute('data-page') === page) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
            
            // Show selected page content
            pageContents.forEach(content => {
                if (content.id === `${page}Page`) {
                    content.style.display = 'block';
                } else {
                    content.style.display = 'none';
                }
            });
            
            // Update page title if needed
            if (page === 'dashboard') {
                updateDashboardStats();
            }
        }
        
        // Open modal for adding/editing data
        function openModal(type, id = null) {
            currentModalType = type;
            editingId = id;
            
            // Set modal title
            const modalTitles = {
                report: id ? 'Edit Laporan' : 'Tambah Laporan',
                task: id ? 'Edit Tugas' : 'Tambah Tugas',
                research: id ? 'Edit Penelitian' : 'Tambah Penelitian',
                jobdesk: id ? 'Edit Job Desk' : 'Tambah Job Desk',
                lecturer: id ? 'Edit Data Dosen' : 'Tambah Data Dosen'
            };
            
            modalTitle.textContent = modalTitles[type];
            
            // Generate form based on type
            let formHTML = '';
            
            if (type === 'report') {
                formHTML = `
                    <div class="form-group">
                        <label for="reportTitle">Judul Laporan</label>
                        <input type="text" id="reportTitle" class="form-control" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="reportLecturer">Dosen</label>
                            <select id="reportLecturer" class="form-control" required>
                                <option value="">Pilih Dosen</option>
                                <option value="Dr. Ahmad Sanusi">Dr. Ahmad Sanusi</option>
                                <option value="Prof. Budi Santoso">Prof. Budi Santoso</option>
                                <option value="Dr. Citra Dewi">Dr. Citra Dewi</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="reportDate">Tanggal</label>
                            <input type="date" id="reportDate" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="reportType">Jenis Laporan</label>
                            <select id="reportType" class="form-control" required>
                                <option value="">Pilih Jenis</option>
                                <option value="Akademik">Akademik</option>
                                <option value="Penelitian">Penelitian</option>
                                <option value="Pengabdian">Pengabdian</option>
                                <option value="Administrasi">Administrasi</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="reportStatus">Status</label>
                            <select id="reportStatus" class="form-control" required>
                                <option value="Draft">Draft</option>
                                <option value="Dalam Review">Dalam Review</option>
                                <option value="Disetujui">Disetujui</option>
                                <option value="Ditolak">Ditolak</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="reportDescription">Deskripsi</label>
                        <textarea id="reportDescription" class="form-control" rows="3"></textarea>
                    </div>
                `;
            } else if (type === 'task') {
                formHTML = `
                    <div class="form-group">
                        <label for="taskTitle">Judul Tugas</label>
                        <input type="text" id="taskTitle" class="form-control" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskLecturer">Dosen</label>
                            <select id="taskLecturer" class="form-control" required>
                                <option value="">Pilih Dosen</option>
                                <option value="Dr. Ahmad Sanusi">Dr. Ahmad Sanusi</option>
                                <option value="Prof. Budi Santoso">Prof. Budi Santoso</option>
                                <option value="Dr. Citra Dewi">Dr. Citra Dewi</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="taskDeadline">Deadline</label>
                            <input type="date" id="taskDeadline" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskPriority">Prioritas</label>
                            <select id="taskPriority" class="form-control" required>
                                <option value="Rendah">Rendah</option>
                                <option value="Sedang">Sedang</option>
                                <option value="Tinggi">Tinggi</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="taskStatus">Status</label>
                            <select id="taskStatus" class="form-control" required>
                                <option value="Belum Dimulai">Belum Dimulai</option>
                                <option value="Dalam Proses">Dalam Proses</option>
                                <option value="Selesai">Selesai</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="taskDescription">Deskripsi</label>
                        <textarea id="taskDescription" class="form-control" rows="3"></textarea>
                    </div>
                `;
            } else if (type === 'research') {
                formHTML = `
                    <div class="form-group">
                        <label for="researchTitle">Judul Penelitian</label>
                        <input type="text" id="researchTitle" class="form-control" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="researchResearcher">Ketua Peneliti</label>
                            <select id="researchResearcher" class="form-control" required>
                                <option value="">Pilih Dosen</option>
                                <option value="Dr. Ahmad Sanusi">Dr. Ahmad Sanusi</option>
                                <option value="Prof. Budi Santoso">Prof. Budi Santoso</option>
                                <option value="Dr. Citra Dewi">Dr. Citra Dewi</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="researchYear">Tahun</label>
                            <input type="number" id="researchYear" class="form-control" min="2000" max="2030" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="researchFundSource">Sumber Dana</label>
                            <select id="researchFundSource" class="form-control" required>
                                <option value="Internal">Internal</option>
                                <option value="Eksternal">Eksternal</option>
                                <option value="Mandiri">Mandiri</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="researchStatus">Status</label>
                            <select id="researchStatus" class="form-control" required>
                                <option value="Dalam Review">Dalam Review</option>
                                <option value="Aktif">Aktif</option>
                                <option value="Selesai">Selesai</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="researchDescription">Deskripsi</label>
                        <textarea id="researchDescription" class="form-control" rows="3"></textarea>
                    </div>
                `;
            } else if (type === 'jobdesk') {
                formHTML = `
                    <div class="form-group">
                        <label for="jobdeskTitle">Nama Job Desk</label>
                        <input type="text" id="jobdeskTitle" class="form-control" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="jobdeskLecturer">Dosen</label>
                            <select id="jobdeskLecturer" class="form-control" required>
                                <option value="">Pilih Dosen</option>
                                <option value="Dr. Ahmad Sanusi">Dr. Ahmad Sanusi</option>
                                <option value="Prof. Budi Santoso">Prof. Budi Santoso</option>
                                <option value="Dr. Citra Dewi">Dr. Citra Dewi</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="jobdeskDepartment">Departemen</label>
                            <select id="jobdeskDepartment" class="form-control" required>
                                <option value="Teknik Informatika">Teknik Informatika</option>
                                <option value="Sistem Informasi">Sistem Informasi</option>
                                <option value="Teknik Komputer">Teknik Komputer</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="jobdeskWorkload">Beban Kerja (jam/minggu)</label>
                            <input type="number" id="jobdeskWorkload" class="form-control" min="1" max="40" required>
                        </div>
                        <div class="form-group">
                            <label for="jobdeskStatus">Status</label>
                            <select id="jobdeskStatus" class="form-control" required>
                                <option value="Aktif">Aktif</option>
                                <option value="Selesai">Selesai</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="jobdeskDescription">Deskripsi</label>
                        <textarea id="jobdeskDescription" class="form-control" rows="3"></textarea>
                    </div>
                `;
            } else if (type === 'lecturer') {
                formHTML = `
                    <div class="form-group">
                        <label for="lecturerName">Nama Lengkap</label>
                        <input type="text" id="lecturerName" class="form-control" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="lecturerNIDN">NIDN</label>
                            <input type="text" id="lecturerNIDN" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="lecturerEmail">Email</label>
                            <input type="email" id="lecturerEmail" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="lecturerDepartment">Departemen</label>
                            <select id="lecturerDepartment" class="form-control" required>
                                <option value="Teknik Informatika">Teknik Informatika</option>
                                <option value="Sistem Informasi">Sistem Informasi</option>
                                <option value="Teknik Komputer">Teknik Komputer</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="lecturerPosition">Jabatan</label>
                            <select id="lecturerPosition" class="form-control" required>
                                <option value="Asisten Ahli">Asisten Ahli</option>
                                <option value="Lektor">Lektor</option>
                                <option value="Lektor Kepala">Lektor Kepala</option>
                                <option value="Guru Besar">Guru Besar</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="lecturerStatus">Status</label>
                        <select id="lecturerStatus" class="form-control" required>
                            <option value="Aktif">Aktif</option>
                            <option value="Cuti">Cuti</option>
                            <option value="Pensiun">Pensiun</option>
                        </select>
                    </div>
                `;
            }
            
            modalFormContent.innerHTML = formHTML;
            
            // If editing, populate form with existing data
            if (id) {
                populateFormForEditing(type, id);
            }
            
            // Show modal
            modal.classList.add('active');
        }
        
        // Populate form for editing
        function populateFormForEditing(type, id) {
            let data;
            
            // Find the data to edit
            if (type === 'report') {
                data = sampleData.reports.find(item => item.id === id);
                if (data) {
                    document.getElementById('reportTitle').value = data.title;
                    document.getElementById('reportLecturer').value = data.lecturer;
                    document.getElementById('reportDate').value = data.date;
                    document.getElementById('reportType').value = data.type;
                    document.getElementById('reportStatus').value = data.status;
                }
            } else if (type === 'task') {
                data = sampleData.tasks.find(item => item.id === id);
                if (data) {
                    document.getElementById('taskTitle').value = data.title;
                    document.getElementById('taskLecturer').value = data.lecturer;
                    document.getElementById('taskDeadline').value = data.deadline;
                    document.getElementById('taskPriority').value = data.priority;
                    document.getElementById('taskStatus').value = data.status;
                }
            } else if (type === 'research') {
                data = sampleData.research.find(item => item.id === id);
                if (data) {
                    document.getElementById('researchTitle').value = data.title;
                    document.getElementById('researchResearcher').value = data.researcher;
                    document.getElementById('researchYear').value = data.year;
                    document.getElementById('researchFundSource').value = data.fundSource;
                    document.getElementById('researchStatus').value = data.status;
                }
            } else if (type === 'jobdesk') {
                data = sampleData.jobdesks.find(item => item.id === id);
                if (data) {
                    document.getElementById('jobdeskTitle').value = data.title;
                    document.getElementById('jobdeskLecturer').value = data.lecturer;
                    document.getElementById('jobdeskDepartment').value = data.department;
                    document.getElementById('jobdeskWorkload').value = data.workload.split(' ')[0];
                    document.getElementById('jobdeskStatus').value = data.status;
                }
            } else if (type === 'lecturer') {
                data = sampleData.lecturers.find(item => item.id === id);
                if (data) {
                    document.getElementById('lecturerName').value = data.name;
                    document.getElementById('lecturerNIDN').value = data.nidn;
                    document.getElementById('lecturerDepartment').value = data.department;
                    document.getElementById('lecturerPosition').value = data.position;
                    document.getElementById('lecturerStatus').value = data.status;
                }
            }
        }
        
        // Close modal
        function closeModal() {
            modal.classList.remove('active');
            modalForm.reset();
            editingId = null;
        }
        
        // Handle form submission
        function handleFormSubmit(e) {
            e.preventDefault();
            
            // Get form data based on modal type
            let newData = {};
            
            if (currentModalType === 'report') {
                newData = {
                    id: editingId || sampleData.reports.length + 1,
                    title: document.getElementById('reportTitle').value,
                    lecturer: document.getElementById('reportLecturer').value,
                    date: document.getElementById('reportDate').value,
                    type: document.getElementById('reportType').value,
                    status: document.getElementById('reportStatus').value
                };
                
                if (editingId) {
                    // Update existing report
                    const index = sampleData.reports.findIndex(item => item.id === editingId);
                    if (index !== -1) {
                        sampleData.reports[index] = newData;
                    }
                } else {
                    // Add new report
                    sampleData.reports.push(newData);
                }
                
                // Reload table
                loadTableData('reports');
                
            } else if (currentModalType === 'task') {
                newData = {
                    id: editingId || sampleData.tasks.length + 1,
                    title: document.getElementById('taskTitle').value,
                    lecturer: document.getElementById('taskLecturer').value,
                    deadline: document.getElementById('taskDeadline').value,
                    priority: document.getElementById('taskPriority').value,
                    status: document.getElementById('taskStatus').value
                };
                
                if (editingId) {
                    // Update existing task
                    const index = sampleData.tasks.findIndex(item => item.id === editingId);
                    if (index !== -1) {
                        sampleData.tasks[index] = newData;
                    }
                } else {
                    // Add new task
                    sampleData.tasks.push(newData);
                }
                
                // Reload table
                loadTableData('tasks');
                
            } else if (currentModalType === 'research') {
                newData = {
                    id: editingId || sampleData.research.length + 1,
                    title: document.getElementById('researchTitle').value,
                    researcher: document.getElementById('researchResearcher').value,
                    year: document.getElementById('researchYear').value,
                    fundSource: document.getElementById('researchFundSource').value,
                    status: document.getElementById('researchStatus').value
                };
                
                if (editingId) {
                    // Update existing research
                    const index = sampleData.research.findIndex(item => item.id === editingId);
                    if (index !== -1) {
                        sampleData.research[index] = newData;
                    }
                } else {
                    // Add new research
                    sampleData.research.push(newData);
                }
                
                // Reload table
                loadTableData('research');
                
            } else if (currentModalType === 'jobdesk') {
                newData = {
                    id: editingId || sampleData.jobdesks.length + 1,
                    title: document.getElementById('jobdeskTitle').value,
                    lecturer: document.getElementById('jobdeskLecturer').value,
                    department: document.getElementById('jobdeskDepartment').value,
                    workload: document.getElementById('jobdeskWorkload').value + ' jam/minggu',
                    status: document.getElementById('jobdeskStatus').value
                };
                
                if (editingId) {
                    // Update existing jobdesk
                    const index = sampleData.jobdesks.findIndex(item => item.id === editingId);
                    if (index !== -1) {
                        sampleData.jobdesks[index] = newData;
                    }
                } else {
                    // Add new jobdesk
                    sampleData.jobdesks.push(newData);
                }
                
                // Reload table
                loadTableData('jobdesks');
                
            } else if (currentModalType === 'lecturer') {
                newData = {
                    id: editingId || sampleData.lecturers.length + 1,
                    name: document.getElementById('lecturerName').value,
                    nidn: document.getElementById('lecturerNIDN').value,
                    department: document.getElementById('lecturerDepartment').value,
                    position: document.getElementById('lecturerPosition').value,
                    status: document.getElementById('lecturerStatus').value
                };
                
                if (editingId) {
                    // Update existing lecturer
                    const index = sampleData.lecturers.findIndex(item => item.id === editingId);
                    if (index !== -1) {
                        sampleData.lecturers[index] = newData;
                    }
                } else {
                    // Add new lecturer
                    sampleData.lecturers.push(newData);
                }
                
                // Reload table
                loadTableData('lecturers');
            }
            
            // Update dashboard stats
            updateDashboardStats();
            
            // Close modal
            closeModal();
            
            // Show success message
            alert(editingId ? 'Data berhasil diperbarui!' : 'Data berhasil ditambahkan!');
        }
        
        // Load table data
        function loadTableData(tableType) {
            let tableBody;
            let data;
            
            if (tableType === 'reports') {
                tableBody = document.getElementById('reportsTable');
                data = sampleData.reports;
            } else if (tableType === 'tasks') {
                tableBody = document.getElementById('tasksTable');
                data = sampleData.tasks;
            } else if (tableType === 'research') {
                tableBody = document.getElementById('researchTable');
                data = sampleData.research;
            } else if (tableType === 'jobdesks') {
                tableBody = document.getElementById('jobdeskTable');
                data = sampleData.jobdesks;
            } else if (tableType === 'lecturers') {
                tableBody = document.getElementById('lecturersTable');
                data = sampleData.lecturers;
            }
            
            if (!tableBody || !data) return;
            
            // Clear table
            tableBody.innerHTML = '';
            
            // Add rows
            data.forEach(item => {
                const row = document.createElement('tr');
                
                if (tableType === 'reports') {
                    row.innerHTML = `
                        <td>${item.title}</td>
                        <td>${item.lecturer}</td>
                        <td>${formatDate(item.date)}</td>
                        <td>${item.type}</td>
                        <td><span class="badge ${getStatusBadgeClass(item.status)}">${item.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn edit" onclick="editItem('${tableType}', ${item.id})">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="action-btn delete" onclick="deleteItem('${tableType}', ${item.id})">
                                    <i class="fas fa-trash"></i> Hapus
                                </button>
                            </div>
                        </td>
                    `;
                } else if (tableType === 'tasks') {
                    row.innerHTML = `
                        <td>${item.title}</td>
                        <td>${item.lecturer}</td>
                        <td>${formatDate(item.deadline)}</td>
                        <td><span class="badge ${getPriorityBadgeClass(item.priority)}">${item.priority}</span></td>
                        <td><span class="badge ${getStatusBadgeClass(item.status)}">${item.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn edit" onclick="editItem('${tableType}', ${item.id})">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="action-btn delete" onclick="deleteItem('${tableType}', ${item.id})">
                                    <i class="fas fa-trash"></i> Hapus
                                </button>
                            </div>
                        </td>
                    `;
                } else if (tableType === 'research') {
                    row.innerHTML = `
                        <td>${item.title}</td>
                        <td>${item.researcher}</td>
                        <td>${item.year}</td>
                        <td>${item.fundSource}</td>
                        <td><span class="badge ${getStatusBadgeClass(item.status)}">${item.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn edit" onclick="editItem('${tableType}', ${item.id})">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="action-btn delete" onclick="deleteItem('${tableType}', ${item.id})">
                                    <i class="fas fa-trash"></i> Hapus
                                </button>
                            </div>
                        </td>
                    `;
                } else if (tableType === 'jobdesks') {
                    row.innerHTML = `
                        <td>${item.title}</td>
                        <td>${item.lecturer}</td>
                        <td>${item.department}</td>
                        <td>${item.workload}</td>
                        <td><span class="badge ${getStatusBadgeClass(item.status)}">${item.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn edit" onclick="editItem('${tableType}', ${item.id})">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="action-btn delete" onclick="deleteItem('${tableType}', ${item.id})">
                                    <i class="fas fa-trash"></i> Hapus
                                </button>
                            </div>
                        </td>
                    `;
                } else if (tableType === 'lecturers') {
                    row.innerHTML = `
                        <td>${item.name}</td>
                        <td>${item.nidn}</td>
                        <td>${item.department}</td>
                        <td>${item.position}</td>
                        <td><span class="badge ${getStatusBadgeClass(item.status)}">${item.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn edit" onclick="editItem('${tableType}', ${item.id})">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="action-btn delete" onclick="deleteItem('${tableType}', ${item.id})">
                                    <i class="fas fa-trash"></i> Hapus
                                </button>
                            </div>
                        </td>
                    `;
                }
                
                tableBody.appendChild(row);
            });
        }
        
        // Edit item
        window.editItem = function(tableType, id) {
            let modalType;
            
            if (tableType === 'reports') modalType = 'report';
            else if (tableType === 'tasks') modalType = 'task';
            else if (tableType === 'research') modalType = 'research';
            else if (tableType === 'jobdesks') modalType = 'jobdesk';
            else if (tableType === 'lecturers') modalType = 'lecturer';
            
            openModal(modalType, id);
        };
        
        // Delete item
        window.deleteItem = function(tableType, id) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                let dataArray;
                
                if (tableType === 'reports') dataArray = sampleData.reports;
                else if (tableType === 'tasks') dataArray = sampleData.tasks;
                else if (tableType === 'research') dataArray = sampleData.research;
                else if (tableType === 'jobdesks') dataArray = sampleData.jobdesks;
                else if (tableType === 'lecturers') dataArray = sampleData.lecturers;
                
                if (dataArray) {
                    const index = dataArray.findIndex(item => item.id === id);
                    if (index !== -1) {
                        dataArray.splice(index, 1);
                        
                        // Reload table
                        loadTableData(tableType);
                        
                        // Update dashboard stats
                        updateDashboardStats();
                        
                        alert('Data berhasil dihapus!');
                    }
                }
            }
        };
        
        // Update dashboard statistics
        function updateDashboardStats() {
            document.getElementById('reportCount').textContent = sampleData.reports.length;
            document.getElementById('taskCount').textContent = sampleData.tasks.length;
            document.getElementById('researchCount').textContent = sampleData.research.length;
            document.getElementById('jobdeskCount').textContent = sampleData.jobdesks.length;
        }
        
        // Load recent activities
        function loadRecentActivities() {
            const activitiesBody = document.getElementById('recentActivities');
            
            // Combine all activities
            const allActivities = [];
            
            // Add reports
            sampleData.reports.forEach(report => {
                allActivities.push({
                    date: report.date,
                    activity: `Laporan "${report.title}" ${report.status.toLowerCase()}`,
                    type: 'Laporan',
                    status: report.status
                });
            });
            
            // Add tasks
            sampleData.tasks.forEach(task => {
                allActivities.push({
                    date: task.deadline,
                    activity: `Tugas "${task.title}" ${task.status.toLowerCase()}`,
                    type: 'Tugas',
                    status: task.status
                });
            });
            
            // Sort by date (newest first)
            allActivities.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Take only 5 most recent
            const recentActivities = allActivities.slice(0, 5);
            
            // Clear table
            activitiesBody.innerHTML = '';
            
            // Add rows
            recentActivities.forEach(activity => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${formatDate(activity.date)}</td>
                    <td>${activity.activity}</td>
                    <td>${activity.type}</td>
                    <td><span class="badge ${getStatusBadgeClass(activity.status)}">${activity.status}</span></td>
                `;
                activitiesBody.appendChild(row);
            });
        }
        
        // Helper function to format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });
        }
        
        // Helper function to get status badge class
        function getStatusBadgeClass(status) {
            if (status === 'Disetujui' || status === 'Selesai' || status === 'Aktif') {
                return 'badge-success';
            } else if (status === 'Dalam Review' || status === 'Dalam Proses') {
                return 'badge-warning';
            } else if (status === 'Ditolak') {
                return 'badge-danger';
            } else {
                return 'badge-info';
            }
        }
        
        // Helper function to get priority badge class
        function getPriorityBadgeClass(priority) {
            if (priority === 'Tinggi') {
                return 'badge-danger';
            } else if (priority === 'Sedang') {
                return 'badge-warning';
            } else {
                return 'badge-success';
            }
        }
    </script>
</body>
</html>
